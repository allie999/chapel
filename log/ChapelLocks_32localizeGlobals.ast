AST dump for ChapelLocks after pass localizeGlobals.
Module use list: Atomics ChapelBase MemConsistency 

{
  type _class_localson_fn[2198955] val _runtime_hdr[2198956]:chpl_comm_on_bundle_t[209359] val _0_tmp[2198958]:chpl_localeID_t[209352] ref _1_this[2198960]:chpl_LocalSpinlock[187432]
  function chpl__init_ChapelLocks[416163]() : void[4] "insert line file info" "module init" "resolved"
  {
    (524136 return _void[55])
  }
  function chpl_LocalSpinlock[187432].init[820510](ref arg this[820513]:chpl_LocalSpinlock[187432], const  ref arg l[820516]:AtomicBool[45877]) : void[4] "compiler generated" "last resort" "method" "primary method" "resolved" "suppress lvalue error"
  {
    val _formal_tmp_l[945344]:AtomicBool[45877] "dead at end of block" "no auto destroy" "no copy" "temp"
    (945347 'move' _formal_tmp_l[945344] l[820516])
    (820532 '.=' this[820513] l[187317] _formal_tmp_l[945344])
    (820536 return _void[55])
  }
  type chpl_LocalSpinlock[187432] val l[187317]:AtomicBool[45877]
  function on_fn[935662](ref arg this[1882176]:chpl_LocalSpinlock[187432]) : void[4] "inlined function" "on" "resolved"
  {
    val tmp[187348]:bool[10] "dead after last mention" "temp"
    ref call_tmp[2322031]:AtomicBool[45877] "dead after last mention" "maybe param" "temp"
    (2322033 'move' call_tmp[2322031](2322035 '.' this[1882176] l[187317]))
    val ret[2406182]:bool[10] "dead after last mention" "RVV" "temp"
    val ret[2406184]:bool[10] "dead at end of block" "insert auto destroy"
    (2406186 'move' ret[2406184] 0)
    const-val call_tmp[2406191]:chpl_localeID_t[209352] "dead after last mention" "expr temp" "maybe param" "temp"
    (2406193 'move' call_tmp[2406191](2406195 '_wide_get_locale' call_tmp[2322031]))
    val isdirect[2406200]:bool[10] "temp"
    (2406202 'move' isdirect[2406200](2406205 call chpl_doDirectExecuteOn[187469] call_tmp[2406191]))
    if isdirect[2406200]
    {
      (2406210 call on_fn[1231105] call_tmp[2322031] ret[2406184])
    }
    {
      val _args_foron_fn[2406214]:_class_localson_fn[2204383] "temp"
      (2406216 'move' _args_foron_fn[2406214](2406218 'stack allocate class' _class_localson_fn[2204383]))
      (2406220 '.=' _args_foron_fn[2406214] _0_tmp[2204386] call_tmp[2406191])
      ref tmp[2406224]:AtomicBool[45877] "temp"
      (2406226 'move' tmp[2406224](2406228 'set reference' call_tmp[2322031]))
      (2406230 '.=' _args_foron_fn[2406214] _1_this[2204388] tmp[2406224])
      ref tmp[2406234]:bool[10] "temp"
      (2406236 'move' tmp[2406234](2406238 'set reference' ret[2406184]))
      (2406240 '.=' _args_foron_fn[2406214] _2_ret[2204390] tmp[2406234])
      val _args_vforon_fn[2406244]:c_void_ptr[149] "temp"
      (2406246 'move' _args_vforon_fn[2406244](2406248 'cast_to_void_star' _args_foron_fn[2406214]))
      val _args_sizeon_fn[2406250]:int(64)[13] "temp"
      (2406252 'move' _args_sizeon_fn[2406250](2406254 'sizeof_bundle' _class_localson_fn[2204383]))
      on(2406257 call wrapon_fn[2204435] call_tmp[2406191] _args_vforon_fn[2406244] _args_sizeon_fn[2406250] _args_foron_fn[2406214])
    }
    (2406263 'move' ret[2406182] ret[2406184])
    val tmp[572219]:bool[10] "dead after last mention" "expr temp" "if-expr result" "insert auto destroy" "temp"
    if ret[2406182]
    {
      (572230 'move' tmp[572219] 1)
    }
    {
      ref call_tmp[2322041]:AtomicBool[45877] "dead after last mention" "maybe param" "temp"
      (2322043 'move' call_tmp[2322041](2322045 '.' this[1882176] l[187317]))
      val ret[2406524]:bool[10] "dead after last mention" "RVV" "temp"
      val ret[2406526]:bool[10] "dead at end of block" "insert auto destroy"
      (2406528 'move' ret[2406526] 0)
      const-val call_tmp[2406533]:chpl_localeID_t[209352] "dead after last mention" "expr temp" "maybe param" "temp"
      (2406535 'move' call_tmp[2406533](2406537 '_wide_get_locale' call_tmp[2322041]))
      val isdirect[2406542]:bool[10] "temp"
      (2406544 'move' isdirect[2406542](2406547 call chpl_doDirectExecuteOn[187469] call_tmp[2406533]))
      if isdirect[2406542]
      {
        (2406552 call on_fn[1231939] call_tmp[2322041] 1 ret[2406526])
      }
      {
        val _args_foron_fn[2406557]:_class_localson_fn[2204496] "temp"
        (2406559 'move' _args_foron_fn[2406557](2406561 'stack allocate class' _class_localson_fn[2204496]))
        (2406563 '.=' _args_foron_fn[2406557] _0_tmp[2204499] call_tmp[2406533])
        ref tmp[2406567]:AtomicBool[45877] "temp"
        (2406569 'move' tmp[2406567](2406571 'set reference' call_tmp[2322041]))
        (2406573 '.=' _args_foron_fn[2406557] _1_this[2204501] tmp[2406567])
        (2406577 '.=' _args_foron_fn[2406557] _2_value[2204503] 1)
        ref tmp[2406581]:bool[10] "temp"
        (2406583 'move' tmp[2406581](2406585 'set reference' ret[2406526]))
        (2406587 '.=' _args_foron_fn[2406557] _3_ret[2204505] tmp[2406581])
        val _args_vforon_fn[2406591]:c_void_ptr[149] "temp"
        (2406593 'move' _args_vforon_fn[2406591](2406595 'cast_to_void_star' _args_foron_fn[2406557]))
        val _args_sizeon_fn[2406597]:int(64)[13] "temp"
        (2406599 'move' _args_sizeon_fn[2406597](2406601 'sizeof_bundle' _class_localson_fn[2204496]))
        on(2406604 call wrapon_fn[2204554] call_tmp[2406533] _args_vforon_fn[2406591] _args_sizeon_fn[2406597] _args_foron_fn[2406557])
      }
      (2406610 'move' ret[2406524] ret[2406526])
      (572239 'move' tmp[572219] ret[2406524])
    }
    (187396 'move' tmp[187348] tmp[572219])
    WhileDo[187353] hazard
    {
      (187346 call chpl_task_yield[209700])
      ref call_tmp[2322051]:AtomicBool[45877] "dead after last mention" "maybe param" "temp"
      (2322053 'move' call_tmp[2322051](2322055 '.' this[1882176] l[187317]))
      val ret[2406271]:bool[10] "dead after last mention" "RVV" "temp"
      val ret[2406273]:bool[10] "dead at end of block" "insert auto destroy"
      (2406275 'move' ret[2406273] 0)
      const-val call_tmp[2406280]:chpl_localeID_t[209352] "dead after last mention" "expr temp" "maybe param" "temp"
      (2406282 'move' call_tmp[2406280](2406284 '_wide_get_locale' call_tmp[2322051]))
      val isdirect[2406289]:bool[10] "temp"
      (2406291 'move' isdirect[2406289](2406294 call chpl_doDirectExecuteOn[187469] call_tmp[2406280]))
      if isdirect[2406289]
      {
        (2406299 call on_fn[1231105] call_tmp[2322051] ret[2406273])
      }
      {
        val _args_foron_fn[2406303]:_class_localson_fn[2204383] "temp"
        (2406305 'move' _args_foron_fn[2406303](2406307 'stack allocate class' _class_localson_fn[2204383]))
        (2406309 '.=' _args_foron_fn[2406303] _0_tmp[2204386] call_tmp[2406280])
        ref tmp[2406313]:AtomicBool[45877] "temp"
        (2406315 'move' tmp[2406313](2406317 'set reference' call_tmp[2322051]))
        (2406319 '.=' _args_foron_fn[2406303] _1_this[2204388] tmp[2406313])
        ref tmp[2406323]:bool[10] "temp"
        (2406325 'move' tmp[2406323](2406327 'set reference' ret[2406273]))
        (2406329 '.=' _args_foron_fn[2406303] _2_ret[2204390] tmp[2406323])
        val _args_vforon_fn[2406333]:c_void_ptr[149] "temp"
        (2406335 'move' _args_vforon_fn[2406333](2406337 'cast_to_void_star' _args_foron_fn[2406303]))
        val _args_sizeon_fn[2406339]:int(64)[13] "temp"
        (2406341 'move' _args_sizeon_fn[2406339](2406343 'sizeof_bundle' _class_localson_fn[2204383]))
        on(2406346 call wrapon_fn[2204435] call_tmp[2406280] _args_vforon_fn[2406333] _args_sizeon_fn[2406339] _args_foron_fn[2406303])
      }
      (2406352 'move' ret[2406271] ret[2406273])
      val tmp[572246]:bool[10] "dead after last mention" "expr temp" "if-expr result" "insert auto destroy" "temp"
      if ret[2406271]
      {
        (572257 'move' tmp[572246] 1)
      }
      {
        ref call_tmp[2322061]:AtomicBool[45877] "dead after last mention" "maybe param" "temp"
        (2322063 'move' call_tmp[2322061](2322065 '.' this[1882176] l[187317]))
        val ret[2406621]:bool[10] "dead after last mention" "RVV" "temp"
        val ret[2406623]:bool[10] "dead at end of block" "insert auto destroy"
        (2406625 'move' ret[2406623] 0)
        const-val call_tmp[2406630]:chpl_localeID_t[209352] "dead after last mention" "expr temp" "maybe param" "temp"
        (2406632 'move' call_tmp[2406630](2406634 '_wide_get_locale' call_tmp[2322061]))
        val isdirect[2406639]:bool[10] "temp"
        (2406641 'move' isdirect[2406639](2406644 call chpl_doDirectExecuteOn[187469] call_tmp[2406630]))
        if isdirect[2406639]
        {
          (2406649 call on_fn[1231939] call_tmp[2322061] 1 ret[2406623])
        }
        {
          val _args_foron_fn[2406654]:_class_localson_fn[2204496] "temp"
          (2406656 'move' _args_foron_fn[2406654](2406658 'stack allocate class' _class_localson_fn[2204496]))
          (2406660 '.=' _args_foron_fn[2406654] _0_tmp[2204499] call_tmp[2406630])
          ref tmp[2406664]:AtomicBool[45877] "temp"
          (2406666 'move' tmp[2406664](2406668 'set reference' call_tmp[2322061]))
          (2406670 '.=' _args_foron_fn[2406654] _1_this[2204501] tmp[2406664])
          (2406674 '.=' _args_foron_fn[2406654] _2_value[2204503] 1)
          ref tmp[2406678]:bool[10] "temp"
          (2406680 'move' tmp[2406678](2406682 'set reference' ret[2406623]))
          (2406684 '.=' _args_foron_fn[2406654] _3_ret[2204505] tmp[2406678])
          val _args_vforon_fn[2406688]:c_void_ptr[149] "temp"
          (2406690 'move' _args_vforon_fn[2406688](2406692 'cast_to_void_star' _args_foron_fn[2406654]))
          val _args_sizeon_fn[2406694]:int(64)[13] "temp"
          (2406696 'move' _args_sizeon_fn[2406694](2406698 'sizeof_bundle' _class_localson_fn[2204496]))
          on(2406701 call wrapon_fn[2204554] call_tmp[2406630] _args_vforon_fn[2406688] _args_sizeon_fn[2406694] _args_foron_fn[2406654])
        }
        (2406707 'move' ret[2406621] ret[2406623])
        (572266 'move' tmp[572246] ret[2406621])
      }
      (187374 'move' tmp[187348] tmp[572246])
      tmp[187348]
    }
    (935669 return _void[55])
  }
  function wrapon_fn[2198995](const in arg dummy_locale_arg[2198997]:chpl_localeID_t[209352], in arg buf[2198999]:c_void_ptr[149], in arg buf_size[2199001]:int(64)[13], in arg c[2199003]:_class_localson_fn[2198955]) : void[4] "inlined function" "on block"
  {
    ref _1_this[2199015]:chpl_LocalSpinlock[187432] "temp"
    (2199020 'move' _1_this[2199015](2199017 '.v' c[2199003] _1_this[2198960]))
    (2199006 call on_fn[935662] _1_this[2199015])
    (2199023 return _void[55])
  }
}