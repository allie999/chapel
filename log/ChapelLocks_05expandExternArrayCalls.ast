AST dump for ChapelLocks after pass expandExternArrayCalls.
Module use list: 

{
  { scopeless
    (187259 'use' Atomics)
    (187261 'use' ChapelBase)
  }
  (187264 'use' MemConsistency)
  type chpl_LocalSpinlock[187386] unknown l[187271](187270 call chpl__processorAtomicType bool[10]) function chpl_LocalSpinlock[187386].lock[187277](arg _mt[187390]:_MT[238], arg this[187388]:chpl_LocalSpinlock[187386]) : _unknown[51] "inline" "method" "primary method"
  {
    { scopeless
      const tmp[187356] "const" "temp"
      (187358 'move' tmp[187356](187354 'deref'(187353 '_wide_get_locale' this)))
      {
        {
          unknown tmp[187302] "temp"
          (187350 'move' tmp[187302](187333 call _cond_test(187335 call ||(187340 call(187337 call . l c"read"))(187345 call(187342 call . l c"testAndSet")(187347 call . memoryOrder c"acquire")))))
          WhileDo[187307]
          {
            { scopeless
              (187300 call chpl_task_yield)
            }
            label _continueLabel[187305]
            (187328 'move' tmp[187302](187311 call _cond_test(187313 call ||(187318 call(187315 call . l c"read"))(187323 call(187320 call . l c"testAndSet")(187325 call . memoryOrder c"acquire")))))
            tmp[187302]
          }
          label _breakLabel[187306]
        }
        (187361 'on block' 0 tmp[187356])
      }
    }
  } function chpl_LocalSpinlock[187386].unlock[187369](arg _mt[187394]:_MT[238], arg this[187392]:chpl_LocalSpinlock[187386]) : _unknown[51] "inline" "method" "primary method"
  {
    (187380 call(187372 call . l c"clear")(187376 call . memoryOrder c"release"))
  }
}